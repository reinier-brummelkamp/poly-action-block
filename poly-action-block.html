<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-ajax/iron-ajax.html">

<link rel="import" href="../neon-animation/neon-animated-pages.html">
<link rel="import" href="../neon-animation/neon-animatable.html">
<link rel="import" href="../neon-animation/neon-animations.html">


<!--https://www.youtube.com/watch?v=Lwvi1u4XXzc&feature=youtu.be&list=PLOU2XLYxmsII5c3Mgw6fNYCzaWrsM3sMN-->
<!--https://www.youtube.com/watch?v=fD2As5RmM8Q-->


<!--https://www.youtube.com/watch?v=cKqwhlnJIdA
http://morethanreal.github.io/neon-animation-demo/bower_components/neon-animation/demo/load/index.html-->

<!--
An element providing a solution to no problem in particular.

Example:

    <poly-action-block></poly-action-block>

@demo
-->
<dom-module id="poly-action-block">

    <style>
        :host {
            display: block;
            box-sizing: border-box;
            /*background-color: purple;*/
        }
    </style>

    <template>
        <iron-ajax auto url="[[dataActionsUrl]]" handle-as="json" last-response="{{ajaxResponse}}" on-response="_actionsReceived"></iron-ajax>
        <neon-animated-pages id="actions" selected="[[_actionIndex]]" entry-animation="slide-from-right-animation" exit-animation="slide-left-animation">
            <template is="dom-repeat" items="[[ajaxResponse.actions]]">
                <neon-animatable>
                    BOO
                    <template is="dom-if" if="{{item.href}}">
                        <a href$="{{item.href}}">
                            <img src$="{{item.img-src}}" /> 
                            {{item.label}}
                        </a>    
                    </template>
                </neon-animatable>
            </template>
        </neon-animated-pages>
    </template>
</dom-module>
<script>
    Polymer({

    is: 'poly-action-block',

    properties: {
        _actionIndex: {
            type: Number,
            value: -1
        },
        _actionCount: {
            type: Number,
            value: 0
        },
        dataActionsUrl: {
            type: String,
            value: null
        },        
        dataActionsObject: {
            type: String,
            value: null
        },
        dataActionsInterval: {
            type: Number,
            value: 5000
        }
    },

    // Element Lifecycle

    ready: function() {
      // `ready` is called after all elements have been configured, but
      // propagates bottom-up. This element's children are ready, but parents
      // are not.
      //
      // This is the point where you should make modifications to the DOM (when
      // necessary), or kick off any processes the element wants to perform.
    },

    attached: function() {
      // `attached` fires once the element and its parents have been inserted
      // into a document.
      //
      // This is a good place to perform any work related to your element's
      // visual state or active behavior (measuring sizes, beginning animations,
      // loading resources, etc).
    },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.
    },

    // Element Behavior

    _actionsReceived: function(e) {
        this._actionCount = e.detail.response.actions.length;
        
        this._showNextAction();
    },

    _showNextAction: function() {
        this._actionIndex = this._actionIndex === (this._actionCount - 1) ? 0 : (this._actionIndex + 1);
            
        this.async(this._showNextAction, this.dataActionsInterval); 
    }
    
  });

</script>